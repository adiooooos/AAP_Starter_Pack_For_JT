========================================
RHEL Network Latency Diagnosis Report
========================================
Analysis Time: {{ analysis_start_time | default('N/A') }}
Hostname: {{ inventory_hostname }}
Network Interface: {{ network_interface | default('N/A') }}
Analysis Duration: {{ analysis_duration | default('N/A') }} seconds

1. Network Interface Status Check
========================================
Interface Name: {{ network_interface | default('N/A') }}
Interface Status: {{ 'UP' if interface_up | default(false) else 'DOWN' }}
MTU Setting: {{ interface_mtu | default('N/A') }}
IP Address: {{ interface_ip | default('N/A') }}

2. Hardware Statistics
========================================
Receive Error Packets: {{ rx_errors | default(0) }}
Transmit Error Packets: {{ tx_errors | default(0) }}
Receive Dropped Packets: {{ rx_dropped | default(0) }}
Transmit Dropped Packets: {{ tx_dropped | default(0) }}

3. System Diagnosis Results
========================================
TCP Retransmit Count: {{ tcp_retransmit | default(0) }}
System Load: {{ system_load_output | default('N/A') }}
Memory Usage:
{{ memory_usage_output | default('N/A') }}

4. Problem Diagnosis Conclusions
========================================
{% if (rx_errors | default(0) | int) > (diagnosis_thresholds.error_packets | default(10) | int) or (tx_errors | default(0) | int) > (diagnosis_thresholds.error_packets | default(10) | int) %}
[CRITICAL] Network interface error packets exceed threshold
{% endif %}
{% if (rx_dropped | default(0) | int) > (diagnosis_thresholds.dropped_packets | default(5) | int) or (tx_dropped | default(0) | int) > (diagnosis_thresholds.dropped_packets | default(5) | int) %}
[POTENTIAL ISSUE] Network interface dropped packets exceed threshold
{% endif %}
{% if (tcp_retransmit | default(0) | int) > 0 %}
[NOTICE] TCP retransmissions detected, network instability may exist
{% endif %}

5. Recommended Actions
========================================
{% if (rx_errors | default(0) | int) > (diagnosis_thresholds.error_packets | default(10) | int) or (tx_errors | default(0) | int) > (diagnosis_thresholds.error_packets | default(10) | int) %}
- Check physical network connection
- Verify cable quality
- Consider updating network card driver
{% endif %}
{% if (rx_dropped | default(0) | int) > (diagnosis_thresholds.dropped_packets | default(5) | int) or (tx_dropped | default(0) | int) > (diagnosis_thresholds.dropped_packets | default(5) | int) %}
- Check network congestion
- Adjust network buffer size
- Optimize application network usage
{% endif %}
{% if (tcp_retransmit | default(0) | int) > 0 %}
- Check network latency
- Optimize TCP parameters
- Consider using more stable network paths
{% endif %}

6. Traffic Capture Files
========================================
{% if traffic_capture.enabled | default(false) and capture_file_path | default('') != '' %}
Capture File: {{ capture_file_path }}
Use tools like Wireshark for deep analysis
{% else %}
Traffic capture not enabled or failed
{% endif %}

========================================
Report Generation Completed
========================================

